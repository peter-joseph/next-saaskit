import{$ as h,a as k}from"./textSelection-DCjboeH2.js";import{r as i}from"./iframe-CU8xeqI0.js";import{$ as P}from"./useFocusRing-DE7Uj8W9.js";import{m as x}from"./index--cEjw2F8.js";import{a as K}from"./useKeyboard-GGR2NUhF.js";function U($){let{onMoveStart:d,onMove:f,onMoveEnd:c}=$,r=i.useRef({didMove:!1,lastPosition:null,id:null}),{addGlobalListener:s,removeGlobalListener:p}=P(),u=i.useCallback((o,a,t,e)=>{t===0&&e===0||(r.current.didMove||(r.current.didMove=!0,d?.({type:"movestart",pointerType:a,shiftKey:o.shiftKey,metaKey:o.metaKey,ctrlKey:o.ctrlKey,altKey:o.altKey})),f?.({type:"move",pointerType:a,deltaX:t,deltaY:e,shiftKey:o.shiftKey,metaKey:o.metaKey,ctrlKey:o.ctrlKey,altKey:o.altKey}))},[d,f,r]),b=K(u),y=i.useCallback((o,a)=>{h(),r.current.didMove&&c?.({type:"moveend",pointerType:a,shiftKey:o.shiftKey,metaKey:o.metaKey,ctrlKey:o.ctrlKey,altKey:o.altKey})},[c,r]),D=K(y),[m,w]=i.useState(null);return x(()=>{if(m==="pointer"){let o=t=>{if(t.pointerId===r.current.id){var e,n;let M=t.pointerType||"mouse";var l,v;b(t,M,t.pageX-((l=(e=r.current.lastPosition)===null||e===void 0?void 0:e.pageX)!==null&&l!==void 0?l:0),t.pageY-((v=(n=r.current.lastPosition)===null||n===void 0?void 0:n.pageY)!==null&&v!==void 0?v:0)),r.current.lastPosition={pageX:t.pageX,pageY:t.pageY}}},a=t=>{if(t.pointerId===r.current.id){let e=t.pointerType||"mouse";D(t,e),r.current.id=null,p(window,"pointermove",o,!1),p(window,"pointerup",a,!1),p(window,"pointercancel",a,!1),w(null)}};return s(window,"pointermove",o,!1),s(window,"pointerup",a,!1),s(window,"pointercancel",a,!1),()=>{p(window,"pointermove",o,!1),p(window,"pointerup",a,!1),p(window,"pointercancel",a,!1)}}},[m,s,p]),{moveProps:i.useMemo(()=>{let o={},a=()=>{k(),r.current.didMove=!1};o.onPointerDown=e=>{e.button===0&&r.current.id==null&&(a(),e.stopPropagation(),e.preventDefault(),r.current.lastPosition={pageX:e.pageX,pageY:e.pageY},r.current.id=e.pointerId,w("pointer"))};let t=(e,n,l)=>{a(),u(e,"keyboard",n,l),y(e,"keyboard")};return o.onKeyDown=e=>{switch(e.key){case"Left":case"ArrowLeft":e.preventDefault(),e.stopPropagation(),t(e,-1,0);break;case"Right":case"ArrowRight":e.preventDefault(),e.stopPropagation(),t(e,1,0);break;case"Up":case"ArrowUp":e.preventDefault(),e.stopPropagation(),t(e,0,-1);break;case"Down":case"ArrowDown":e.preventDefault(),e.stopPropagation(),t(e,0,1);break}},o},[r,u,y])}}export{U as $};
