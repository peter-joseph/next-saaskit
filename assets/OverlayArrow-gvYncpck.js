import{l as K,u as ut}from"./useFocusRing-DE7Uj8W9.js";import{a as G}from"./NumberFormatter-ZLOyqEzC.js";import{r as M,R as mt}from"./iframe-CU8xeqI0.js";import{m as q,b as gt,f as vt,a as $t,c as ht}from"./index--cEjw2F8.js";import{$ as V}from"./useResizeObserver-BjmhNvD3.js";import{$ as bt}from"./context-m9Gn5ytb.js";import{$ as xt}from"./useControlledState-B_NIEXLA.js";const S={top:"top",bottom:"top",left:"left",right:"left"},j={top:"bottom",bottom:"top",left:"right",right:"left"},Et={top:"left",left:"top"},J={top:"height",left:"width"},it={width:"totalWidth",height:"totalHeight"},Z={};let Pt=()=>typeof document<"u"?window.visualViewport:null;function tt(e,t){let l=0,r=0,o=0,n=0,c=0,f=0,p={};var s;let u=((s=t?.scale)!==null&&s!==void 0?s:1)>1;if(e.tagName==="BODY"||e.tagName==="HTML"){let $=document.documentElement;o=$.clientWidth,n=$.clientHeight;var h;l=(h=t?.width)!==null&&h!==void 0?h:o;var v;r=(v=t?.height)!==null&&v!==void 0?v:n,p.top=$.scrollTop||e.scrollTop,p.left=$.scrollLeft||e.scrollLeft,t&&(c=t.offsetTop,f=t.offsetLeft)}else({width:l,height:r,top:c,left:f}=Y(e,!1)),p.top=e.scrollTop,p.left=e.scrollLeft,o=l,n=r;if(ut()&&(e.tagName==="BODY"||e.tagName==="HTML")&&u){p.top=0,p.left=0;var m;c=(m=t?.pageTop)!==null&&m!==void 0?m:0;var a;f=(a=t?.pageLeft)!==null&&a!==void 0?a:0}return{width:l,height:r,totalWidth:o,totalHeight:n,scroll:p,top:c,left:f}}function Tt(e){return{top:e.scrollTop,left:e.scrollLeft,width:e.scrollWidth,height:e.scrollHeight}}function et(e,t,l,r,o,n,c){var f;let p=(f=o.scroll[e])!==null&&f!==void 0?f:0,s=r[J[e]],u=c[e]+r.scroll[S[e]]+n,h=c[e]+r.scroll[S[e]]+s-n,v=t-p+r.scroll[S[e]]+c[e]-r[S[e]],m=t-p+l+r.scroll[S[e]]+c[e]-r[S[e]];return v<u?u-v:m>h?Math.max(h-m,u-v):0}function Ct(e){let t=window.getComputedStyle(e);return{top:parseInt(t.marginTop,10)||0,bottom:parseInt(t.marginBottom,10)||0,left:parseInt(t.marginLeft,10)||0,right:parseInt(t.marginRight,10)||0}}function lt(e){if(Z[e])return Z[e];let[t,l]=e.split(" "),r=S[t]||"right",o=Et[r];S[l]||(l="center");let n=J[r],c=J[o];return Z[e]={placement:t,crossPlacement:l,axis:r,crossAxis:o,size:n,crossSize:c},Z[e]}function B(e,t,l,r,o,n,c,f,p,s,u){let{placement:h,crossPlacement:v,axis:m,crossAxis:a,size:$,crossSize:x}=r,P={};var i;P[a]=(i=e[a])!==null&&i!==void 0?i:0;var _,d,b,g;v==="center"?P[a]+=(((_=e[x])!==null&&_!==void 0?_:0)-((d=l[x])!==null&&d!==void 0?d:0))/2:v!==a&&(P[a]+=((b=e[x])!==null&&b!==void 0?b:0)-((g=l[x])!==null&&g!==void 0?g:0)),P[a]+=n;const C=e[a]-l[x]+p+s,T=e[a]+e[x]-p-s;if(P[a]=G(P[a],C,T),h===m){let z=f?u[$]:u[it[$]];P[j[m]]=Math.floor(z-e[m]+o)}else P[m]=Math.floor(e[m]+e[$]+o);return P}function Lt(e,t,l,r,o,n,c,f,p,s,u){var h,v;let m=(e.top!=null?e.top:p[it.height]-((h=e.bottom)!==null&&h!==void 0?h:0)-c)-((v=p.scroll.top)!==null&&v!==void 0?v:0),a=s?l.top:0;var $,x,P;let i={top:Math.max(t.top+a,(($=u?.offsetTop)!==null&&$!==void 0?$:t.top)+a),bottom:Math.min(t.top+t.height+a,((x=u?.offsetTop)!==null&&x!==void 0?x:0)+((P=u?.height)!==null&&P!==void 0?P:0))};var _,d,b,g;return f!=="top"?Math.max(0,i.bottom-m-(((_=o.top)!==null&&_!==void 0?_:0)+((d=o.bottom)!==null&&d!==void 0?d:0)+n)):Math.max(0,m+c-i.top-(((b=o.top)!==null&&b!==void 0?b:0)+((g=o.bottom)!==null&&g!==void 0?g:0)+n))}function ot(e,t,l,r,o,n,c,f){let{placement:p,axis:s,size:u}=n;var h,v;if(p===s)return Math.max(0,l[s]-((h=c.scroll[s])!==null&&h!==void 0?h:0)-(e[s]+(f?t[s]:0))-((v=r[s])!==null&&v!==void 0?v:0)-r[j[s]]-o);var m,a;return Math.max(0,e[u]+e[s]+(f?t[s]:0)-l[s]-l[u]+((m=c.scroll[s])!==null&&m!==void 0?m:0)-((a=r[s])!==null&&a!==void 0?a:0)-r[j[s]]-o)}function _t(e,t,l,r,o,n,c,f,p,s,u,h,v,m,a,$,x,P){let i=lt(e),{size:_,crossAxis:d,crossSize:b,placement:g,crossPlacement:C}=i,T=B(t,f,l,i,u,h,s,v,a,$,p),z=u,F=ot(f,s,t,o,n+u,i,p,x);if(c&&l[_]>F){let W=lt(`${j[g]} ${C}`),pt=B(t,f,l,W,u,h,s,v,a,$,p);ot(f,s,t,o,n+u,W,p,x)>F&&(i=W,T=pt,z=u)}let y="bottom";i.axis==="top"?i.placement==="top"?y="top":i.placement==="bottom"&&(y="bottom"):i.crossAxis==="top"&&(i.crossPlacement==="top"?y="bottom":i.crossPlacement==="bottom"&&(y="top"));let L=et(d,T[d],l[b],f,p,n,s);T[d]+=L;let H=Lt(T,f,s,v,o,n,l.height,y,p,x,P);m&&m<H&&(H=m),l.height=Math.min(l.height,H),T=B(t,f,l,i,z,h,s,v,a,$,p),L=et(d,T[d],l[b],f,p,n,s),T[d]+=L;let R={},A=t[d]-T[d]-o[S[d]],I=A+.5*t[b];const X=a/2+$;var N,k,w,O;const U=S[d]==="left"?((N=o.left)!==null&&N!==void 0?N:0)+((k=o.right)!==null&&k!==void 0?k:0):((w=o.top)!==null&&w!==void 0?w:0)+((O=o.bottom)!==null&&O!==void 0?O:0),at=l[b]-U-a/2-$,ct=t[d]+a/2-(T[d]+o[S[d]]),st=t[d]+t[b]-a/2-(T[d]+o[S[d]]),ft=G(I,ct,st);R[d]=G(ft,X,at),{placement:g,crossPlacement:C}=i,a?A=R[d]:C==="right"?A+=t[b]:C==="center"&&(A+=t[b]/2);let D=g==="left"||g==="top"?l[_]:0,dt={x:g==="top"||g==="bottom"?A:D,y:g==="left"||g==="right"?A:D};return{position:T,maxHeight:H,arrowOffsetLeft:R.left,arrowOffsetTop:R.top,placement:g,triggerAnchorPoint:dt}}function wt(e){let{placement:t,targetNode:l,overlayNode:r,scrollNode:o,padding:n,shouldFlip:c,boundaryElement:f,offset:p,crossOffset:s,maxHeight:u,arrowSize:h=0,arrowBoundaryOffset:v=0}=e,m=Pt(),a=r instanceof HTMLElement?Ht(r):document.documentElement,$=a===document.documentElement;const x=window.getComputedStyle(a).position;let P=!!x&&x!=="static",i=$?Y(l,!1):rt(l,a,!1);if(!$){let{marginTop:R,marginLeft:A}=window.getComputedStyle(l);i.top+=parseInt(R,10)||0,i.left+=parseInt(A,10)||0}let _=Y(r,!0),d=Ct(r);var b,g;_.width+=((b=d.left)!==null&&b!==void 0?b:0)+((g=d.right)!==null&&g!==void 0?g:0);var C,T;_.height+=((C=d.top)!==null&&C!==void 0?C:0)+((T=d.bottom)!==null&&T!==void 0?T:0);let z=Tt(o),F=tt(f,m),y=tt(a,m),L=rt(f,a,!1),H=K(f,a);return _t(t,i,_,z,d,n,c,F,y,L,p,s,P,u,h,v,H,m)}function Q(e,t){let{top:l,left:r,width:o,height:n}=e.getBoundingClientRect();return t&&e instanceof e.ownerDocument.defaultView.HTMLElement&&(o=e.offsetWidth,n=e.offsetHeight),{top:l,left:r,width:o,height:n}}function Y(e,t){let{top:l,left:r,width:o,height:n}=Q(e,t),{scrollTop:c,scrollLeft:f,clientTop:p,clientLeft:s}=document.documentElement;return{top:l+c-p,left:r+f-s,width:o,height:n}}function rt(e,t,l){let r=window.getComputedStyle(e),o;if(r.position==="fixed")o=Q(e,l);else{o=Y(e,l);let n=Y(t,l),c=window.getComputedStyle(t);n.top+=(parseInt(c.borderTopWidth,10)||0)-t.scrollTop,n.left+=(parseInt(c.borderLeftWidth,10)||0)-t.scrollLeft,o.top-=n.top,o.left-=n.left}return o.top-=parseInt(r.marginTop,10)||0,o.left-=parseInt(r.marginLeft,10)||0,o}function Ht(e){let t=e.offsetParent;if(t&&t===document.body&&window.getComputedStyle(t).position==="static"&&!nt(t)&&(t=document.documentElement),t==null)for(t=e.parentElement;t&&!nt(t);)t=t.parentElement;return t||document.documentElement}function nt(e){let t=window.getComputedStyle(e);return t.transform!=="none"||/transform|perspective/.test(t.willChange)||t.filter!=="none"||t.contain==="paint"||"backdropFilter"in t&&t.backdropFilter!=="none"||"WebkitBackdropFilter"in t&&t.WebkitBackdropFilter!=="none"}const Rt=new WeakMap;function At(e){let{triggerRef:t,isOpen:l,onClose:r}=e;M.useEffect(()=>{if(!l||r===null)return;let o=n=>{let c=n.target;if(!t.current||c instanceof Node&&!K(c,t.current)||n.target instanceof HTMLInputElement||n.target instanceof HTMLTextAreaElement)return;let f=r||Rt.get(t.current);f&&f()};return window.addEventListener("scroll",o,!0),()=>{window.removeEventListener("scroll",o,!0)}},[l,r,t])}let E=typeof document<"u"?window.visualViewport:null;function Zt(e){let{direction:t}=bt(),{arrowSize:l,targetRef:r,overlayRef:o,arrowRef:n,scrollRef:c=o,placement:f="bottom",containerPadding:p=12,shouldFlip:s=!0,boundaryElement:u=typeof document<"u"?document.body:null,offset:h=0,crossOffset:v=0,shouldUpdatePosition:m=!0,isOpen:a=!0,onClose:$,maxHeight:x,arrowBoundaryOffset:P=0}=e,[i,_]=M.useState(null),d=[m,f,o.current,r.current,n?.current,c.current,p,s,u,h,v,a,t,x,P,l],b=M.useRef(E?.scale);M.useEffect(()=>{a&&(b.current=E?.scale)},[a]);let g=M.useCallback(()=>{if(m===!1||!a||!o.current||!r.current||!u||E?.scale!==b.current)return;let L=null;if(c.current&&K(c.current,document.activeElement)){var H;let w=(H=document.activeElement)===null||H===void 0?void 0:H.getBoundingClientRect(),O=c.current.getBoundingClientRect();var R;if(L={type:"top",offset:((R=w?.top)!==null&&R!==void 0?R:0)-O.top},L.offset>O.height/2){L.type="bottom";var A;L.offset=((A=w?.bottom)!==null&&A!==void 0?A:0)-O.bottom}}let I=o.current;if(!x&&o.current){var X;I.style.top="0px",I.style.bottom="";var N;I.style.maxHeight=((N=(X=window.visualViewport)===null||X===void 0?void 0:X.height)!==null&&N!==void 0?N:window.innerHeight)+"px"}let k=wt({placement:St(f,t),overlayNode:o.current,targetNode:r.current,scrollNode:c.current||o.current,padding:p,shouldFlip:s,boundaryElement:u,offset:h,crossOffset:v,maxHeight:x,arrowSize:l??(n?.current?Q(n.current,!0).width:0),arrowBoundaryOffset:P});if(k.position){if(I.style.top="",I.style.bottom="",I.style.left="",I.style.right="",Object.keys(k.position).forEach(w=>I.style[w]=k.position[w]+"px"),I.style.maxHeight=k.maxHeight!=null?k.maxHeight+"px":"",L&&document.activeElement&&c.current){let w=document.activeElement.getBoundingClientRect(),O=c.current.getBoundingClientRect(),U=w[L.type]-O[L.type];c.current.scrollTop+=U-L.offset}_(k)}},d);q(g,d),Mt(g),V({ref:o,onResize:g}),V({ref:r,onResize:g});let C=M.useRef(!1);q(()=>{let L,H=()=>{C.current=!0,clearTimeout(L),L=setTimeout(()=>{C.current=!1},500),g()},R=()=>{C.current&&H()};return E?.addEventListener("resize",H),E?.addEventListener("scroll",R),()=>{E?.removeEventListener("resize",H),E?.removeEventListener("scroll",R)}},[g]);let T=M.useCallback(()=>{C.current||$?.()},[$,C]);At({triggerRef:r,isOpen:a,onClose:$&&T});var z,F,y;return{overlayProps:{style:{position:i?"absolute":"fixed",top:i?void 0:0,left:i?void 0:0,zIndex:1e5,...i?.position,maxHeight:(z=i?.maxHeight)!==null&&z!==void 0?z:"100vh"}},placement:(F=i?.placement)!==null&&F!==void 0?F:null,triggerAnchorPoint:(y=i?.triggerAnchorPoint)!==null&&y!==void 0?y:null,arrowProps:{"aria-hidden":"true",role:"presentation",style:{left:i?.arrowOffsetLeft,top:i?.arrowOffsetTop}},updatePosition:g}}function Mt(e){q(()=>(window.addEventListener("resize",e,!1),()=>{window.removeEventListener("resize",e,!1)}),[e])}function St(e,t){return t==="rtl"?e.replace("start","right").replace("end","left"):e.replace("start","left").replace("end","right")}function jt(e){let[t,l]=xt(e.isOpen,e.defaultOpen||!1,e.onOpenChange);const r=M.useCallback(()=>{l(!0)},[l]),o=M.useCallback(()=>{l(!1)},[l]),n=M.useCallback(()=>{l(!t)},[l,t]);return{isOpen:t,setOpen:l,open:r,close:o,toggle:n}}const yt=M.createContext({placement:"bottom"}),Ut=M.forwardRef(function(t,l){[t,l]=gt(t,l,yt);let r=t.placement,o={position:"absolute",transform:r==="top"||r==="bottom"?"translateX(-50%)":"translateY(-50%)"};r!=null&&(o[r]="100%");let n=vt({...t,defaultClassName:"react-aria-OverlayArrow",values:{placement:r}});n.style&&Object.keys(n.style).forEach(f=>n.style[f]===void 0&&delete n.style[f]);let c=$t(t);return mt.createElement(ht.div,{...c,...n,style:{...o,...n.style},ref:l,"data-placement":r})});export{jt as $,Rt as a,Zt as b,yt as c,Ut as d};
